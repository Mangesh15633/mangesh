<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">

<title>One Automation Solution - Dashboard</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
<!-- <link rel="icon" href="favicon.ico"> -->
<!-- Custom Css for Vertical Navigation for Config pages -->
<link href="/resources/css/V-Nav.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/resources/css/switch.css" type="text/css">

<link href="/resources/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="vendor/bootstrap/css/bootstrap-select.min.css" rel="stylesheet">
<link href="/resources/css/project_bootstrap.min.css" rel="stylesheet">

<script>
window.addEventListener('load', function () {	
    if(document.location.href.indexOf('loginUrl') > -1) { 
       document.location.href = '/resources/index.html';
    }
});
</script>

</head>

<body id="page-top">




	<!-- Page Wrapper -->
	<div id="wrapper">

		<!-- Sidebar -->
		<ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

			<!-- Sidebar - Brand -->
			<a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
				<div class="sidebar-brand-icon rotate-n-15">
					<i class="fas fa-cogs"></i>
				</div>
				<div class="sidebar-brand-text mx-3">One Automation Solution</div>
			</a>

			<!-- Divider -->
			<hr class="sidebar-divider my-0">

			<!-- Nav Item - Dashboard -->
			<li class="nav-item active"><a class="nav-link" href="/resources/index.html"> <i class="fas fa-fw fa-tachometer-alt"></i> <span>Dashboard</span></a></li>

			<!-- Divider -->
			<hr class="sidebar-divider">

			<!-- Heading -->
			<div class="sidebar-heading">Interface</div>

			<!-- Nav Item - Pages Collapse Menu -->
			<li class="nav-item"><a class="nav-link" href="/resources/initiate.html"> <i class="fas fa-fw fa-caret-square-right"></i> <span>Initiate</span></a></li>
			<li class="nav-item" id="TM_Menu" style="display: block;"><a class="nav-link" href="/resources/test_master.html"> <i class="fas fa-list-alt"></i> <span>Test Master</span></a></li>
			<li class="nav-item"><a class="nav-link" href="/resources/results.html"> <i class="fas fa-fw fa-chart-pie"></i> <span>Results</span></a></li>
			<li class="nav-item"><a class="nav-link" href="/resources/priority.html"> <i class="fas fa-check-double"></i> <span>Test Prioritization</span></a></li>

		<!-- Divider -->
		<div id="AdminMenu" style="display: block;">
			<hr class="sidebar-divider"></hr>
			
		<!-- Heading -->
			
			<div class="sidebar-heading" >Configs</div>
			
			<!-- Nav Item - Utilities Collapse Menu -->
			<li class="nav-item m-0" ><a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities" aria-expanded="true"
				aria-controls="collapseUtilities"> <i class="fas fa-fw fa-wrench"></i> <span>Admin</span>
			</a>

				<div id="collapseUtilities" class="collapse hide" aria-labelledby="headingUtilities" data-parent="#accordionSidebar">
					<div class="bg-white py-2 collapse-inner rounded">
						
						<a class="collapse-item" href="/resources/user.html">User Management</a> <a class="collapse-item" href="/resources/master-config.html">Master Configs</a> <a class="collapse-item"
							href="/resources/project-config.html">Project Configs</a>
					</div>
				</div></li>
				</div>
			<!-- Divider -->
			<hr class="sidebar-divider">
			<!-- Heading -->
			<div class="sidebar-heading">Others</div>

			<!-- Nav Item - Pages Collapse Menu -->
			<li class="nav-item"><a class="nav-link" href="/resources/faqs.html"> <i class="fas fa-question-circle"></i> <span>FAQs</span></a></li>
			<li class="nav-item"><a class="nav-link" href="/resources/about.html"> <i class="fas fa-info-circle"></i> <span>About</span></a></li>



			<!-- Sidebar Toggler (Sidebar) -->
			<div class="text-center d-none d-md-inline">
				<button class="rounded-circle border-0" id="sidebarToggle" onclick="rem_sidebar()"></button>
			</div>



		</ul>
		<!-- End of Sidebar -->

		<!-- Content Wrapper -->
		<div id="content-wrapper" class="d-flex flex-column">

			<!-- Main Content -->
			<div id="content">

				<!-- Topbar -->
				<nav class="navbar navbar-expand navbar-light bg-white topbar mb-1 static-top shadow">

					<!-- Sidebar Toggle (Topbar) -->
					<button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
						<i class="fa fa-bars"></i>
					</button>



					<!-- Topbar Navbar -->
					<!-- Topbar Navbar -->
					<ul class="navbar-nav ml-auto">


						<div class="container">
							<!-- Nav Item - Alerts -->

							<form id="testForm" name="serverSwitch" action="serverSwitch" method="post">
								<label class="mt-2 switch"> <input type="checkbox" id="serverSwitch" name="check1" checked='checked' onchange="cTrig(this)">
									<div id="box" class="slider round">
										<span class="on">ON</span> <span class="off">OFF</span>
									</div>
								</label>
							</form>
							<div class="topbar-divider"></div>

							<span id="loginUser" class="ml-1 mr-4 text-success font-weight-bold small"><< Full Name >></span> <span id="loginEmail" hidden>loginEmailValue</span> <span id="hiddenSpan" hidden>hiddenValueForPage</span>

							<!-- Nav Item - User Information -->
							<li class="nav-item"><a href="#" data-toggle="modal" data-target="#logoutModal"> <i class="fas fa-sign-out-alt" style="color: #C0C0C0"></i>
							</a></li>
						</div>
					</ul>

					<!-- End of Topbar -->
				</nav>


				<!-- Begin Page Content -->
				<h6 class="dropdown-header">

					<!-- Page Heading -->
					<div class="card shadow">
						<div class="card-header py-3">
							<div class="row">
								<div class="mt-1 col-sm-5 text-left">
									<h6 class="m-0 font-weight-bold text-primary" style="font-size: 15px">Project Automation Summary</h6>
								</div>

								<div class="mt-2 col-sm-2 text-right">
									<div id="LoadingImage" class="text-right" style="display: none">
										<progress></progress>
									</div>
								</div>
								
								<div class="col-sm-5 text-right">
									<span class="ml-1 text-right"> <select class="selectpicker show-tick Atype" data-width="140px" data-style="btn btn-secondary shadow-sm" id="AType" name="AType" multiple
										data-max-options="1" required>
									</select>
									</span>
									<span class="ml-1 text-left">
										<select class="selectpicker show-tick" data-style="btn btn-secondary shadow-sm" id="DaysCount" name="DaysCount" multiple data-max-options="1" required>
											<option value="7">This Week</option>
											<option value="15">This Fortnight</option>
											<option value="30" selected>This Month</option>
											<option value="60">Last 2 Months</option>
											<option value="90">Last 3 Months</option>
										</select>
									</span>
									<button class="ml-1 btn btn-primary shadow-sm" onClick="printToPDF();">
										<i class="fas fa-download fa-sm text-right"></i> Generate PDF
									</button>
									
								</div>
								
								
							</div>

						</div>
						<p></p>

						<!-- Content Row -->
						<div id="pdfContent" class="py-3 px-0 card border-info shadow">

							<div class="row">

								<!--  Total Scripts Developed -->
								<div class="col-xl-3 col-md-6 mb-4">
									<div class="card border-left-success border-right-success shadow h-80">
										<div class="card-body">
											<div class="row no-gutters align-items-center">
												<div class="col">
													<div class="text-xs font-weight-bold text-success text-uppercase mb-1">Total_Planned_Tests</div>
													<div class="h5 mb-0 font-weight-bold text-gray-800" id="Planned_Count"></div>
												</div>
												<div class="col-auto ml-1">
													<i class="fas fa-tasks fa-2x text-gray-300"></i>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="col-xl-3 col-md-6 mb-4">
									<div class="card border-left-info border-right-info shadow h-80 ml-1">
										<div class="card-body">
											<div class="row no-gutters align-items-center">
												<div class="col">
													<div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total_Tests_Automated</div>
													<div class="h5 mb-0 font-weight-bold text-gray-800" id="Automated_Count"></div>
												</div>
												<div class="col-auto">
													<i class="fas fa-cog fa-2x text-gray-300"></i>
												</div>
											</div>
										</div>
									</div>
								</div>

								<!-- Total Scripts Developed -->
								<div class="col-xl-3 col-md-6 mb-4">
									<div class="card border-left-info border-right-info shadow h-80">
										<div class="card-body">
											<div class="row no-gutters align-items-center">
												<div class="col">
													<div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total_Scripts_Developed</div>
													<div class="h5 mb-0 font-weight-bold text-gray-800" id="ScriptDeveloped_Count"></div>
												</div>
												<div class="col-auto">
													<i class="fas fa-code fa-2x text-gray-300"></i>
												</div>
											</div>
										</div>
									</div>
								</div>

								<!-- Executions Completed Card -->
								<div class="col-xl-3 col-md-6 mb-4">
									<div class="card border-left-success border-right-success shadow mr-1 h-80">
										<div class="card-body">
											<div class="row no-gutters align-items-center">
												<div class="col mr-2">
													<div class="text-xs font-weight-bold text-success text-uppercase mb-1">Executions_Completed</div>
													<div class="row no-gutters align-items-center">
														<div class="col-auto">
															<div class="h5 mb-0 mr-3 font-weight-bold text-gray-800" id="ExecutionsCompleted_Count"></div>
														</div>

													</div>
												</div>
												<div class="col-auto">
													<i class="fas fa-certificate fa-2x text-gray-300"></i>
												</div>
											</div>
										</div>
									</div>
								</div>


							</div>
							</form>

							<!-- First Row -->

							<div class="row">
								<div class="col-xl-6 col-lg-5">
									<div class="card shadow mb-4 ml-1">
										<!-- Card Header Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Automated Test coverage Vs Total Test coverage</h6>

										</div>

										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="PieAAZeroDataDiv" style="display: none"></div>
											<div class="chart-pie pt-4 pb-2 align-items-center" id="PieAA_ChartDiv">
												<div id="pieAA_spinner" class="text-center">
													<div class="spinner-grow spinner-grow-sm" role="status">
														<span class="sr-only">Loading...</span>
													</div>
												</div>
												<canvas width="479" height="239" id="pieChart_AA">
												</canvas>
											</div>
											
										</div>
									</div>
								</div>


								<div class="col-xl-6 col-lg-5">
									<div class="card shadow mb-4 mr-1">
										<!-- Card Header - Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Planned Vs Actual Automated Test coverage</h6>

										</div>
										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="PiePvAZeroDataDiv" style="display: none"></div>
											<div class="chart-pie pt-4 pb-2 align-items-center" id="PiePvA_ChartDiv">
												<div id="piePvA_spinner" class="text-center">
													<div class="spinner-grow spinner-grow-sm" role="status">
														<span class="sr-only">Loading...</span>
													</div>
												</div>
												<canvas width="479" height="239" id="pieChart_PvA"></canvas>
											</div>

										</div>
									</div>
								</div>
							</div>



							<!-- Module wise Progress Chart Row -->
							<div class="row">
								<div class="col-lg-1 mb-2"></div>
								<!-- Content Column -->
								<div class="col-lg-10 mb-2">

									<!-- Project Card Example -->
									<div class="card shadow mb-3">
										<div class="card-header py-3">
											<h6 class="m-0 font-weight-bold text-dark">Module wise Automation Progress</h6>
										</div>

										<div class="card-body" id="Module_Progress">
											<div class="alert alert-info text-center" id="ModProgress_ZeroDataDiv" style="display: none;"></div>
											<div id="Module_spinner" class="text-center">
												<div class="spinner-grow spinner-grow-sm" role="status">
													<span class="sr-only">Loading...</span>
												</div>
											</div>
											<!-- Progress Bar content from Javascript here -->
										</div>
									</div>
								</div>


							</div>
							<div class="row">
								<div class="col-xl-1"></div>
								<div class="col-xl-10" id="Risk_FullDiv">
									<div class="card shadow mb-4">
										<!-- Card Header - Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Risk Breakup View</h6>
											
										</div>
										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="Risk_ZeroDataDiv" style="display: none;"></div>
											<div id="IndRisk_spinner" class="text-center">
												<div class="spinner-grow spinner-grow-sm" role="status">
													<span class="sr-only">Loading...</span>
												</div>
											</div>
											<div class="row align-items-center" id="RiskChart">
												<div class="col col-sm-7">
													<canvas width="500" height="250" id="RiskPieChart"></canvas>
												</div>
												<div id="RiskChartValues" class="col col-sm-5" style="display: none;">
													<div class="p-2">
														<span class="medium  font-weight-bold">Automation Type: </span> <span id="ATypeValue" class="px-2 medium font-italic"></span>
													</div>
													<div class="p-2">
														<span class="medium  font-weight-bold">Total Test Cases: </span> <span id="TCCountValue" class="px-2 medium font-italic"></span>
													</div>
													<div class="p-2">
														<span class="medium font-weight-bold">Low Risk: </span> <span id="LowRiskValue" class="px-2 medium font-italic"></span>
													</div>
													<div class="p-2">
														<span class="medium font-weight-bold">Average Risk: </span> <span id="AvgRiskValue" class="px-2 medium font-italic"></span>
													</div>
													<div class="p-2">
														<span class="medium font-weight-bold">High Risk: </span> <span id="HighRiskValue" class="px-2 medium font-italic"></span>
													</div>
													<div class="p-2">
														<span class="medium font-weight-bold">Derived Risk: </span> <span id="DervicedRiskValue" class="px-2 medium font-italic"></span>
													</div>
													<div class="p-2">
														<span class="medium font-weight-bold">Overall Status: </span> <span id="StatusValue" class="px-2 medium font-italic"></span>
													</div>
												</div>
											</div>

										</div>
									</div>
								</div>
							</div>

							<!-- Execution Per Browser Chart Row -->
							<div class="row">
								<div class="" id="SType_SideDiv"></div>
								<!-- Executions per Selection Type Chart -->
								<div class="col-xl-6" id="SType_FullDiv">
									<div class="card shadow mb-4">
										<!-- Card Header - Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Execution Count per Selection Type (Full, Partial, Risk-Based)</h6>

										</div>
										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="SelectionExecs_ZeroDataDiv" style="display: none;"></div>
											<div id="SType_spinner" class="text-center">
												<div class="spinner-grow spinner-grow-sm" role="status">
													<span class="sr-only">Loading...</span>
												</div>
											</div>
											<div class="chart-area" id="STypeExecs_ChartDiv">
												<canvas width="848" height="320" id="Exec_per_SType"></canvas>
											</div>
										</div>
									</div>
								</div>
								<!-- Executions per Browser Chart -->
								<div class="col-xl-6 col-lg-5" id="BrowserExecs_CardDiv">
									<div class="card shadow mb-4">
										<!-- Card Header - Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Executions per Browser till date</h6>

										</div>
										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="BrowserExecs_ZeroDataDiv" style="display: none;"></div>
											<div id="BrowserExecs_spinner" class="text-center">
												<div class="spinner-grow spinner-grow-sm" role="status">
													<span class="sr-only">Loading...</span>
												</div>
											</div>
											<div class="chart-area" id="BrowserExecs_ChartDiv">
												<canvas width="848" height="320" id="Exec_per_Browser"></canvas>
											</div>
										</div>
									</div>
								</div>

							</div>


							<!-- Execution Per Test Type and Environment Charts Row -->
							<div class="row">

								<!-- Executions per Environment Chart -->
								<div class="col-xl-6 col-lg-5">
									<div class="card shadow mb-4 ml-1">
										<!-- Card Header - Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Executions per Test Type till date</h6>

										</div>
										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="TTypeExecs_ZeroDataDiv" style="display: none;"></div>
											<div id="TTypeExecs_spinner" class="text-center">
												<div class="spinner-grow spinner-grow-sm" role="status">
													<span class="sr-only">Loading...</span>
												</div>
											</div>
											<div class="chart-area" id="TTypeExecs_ChartDiv">
												<canvas width="479" height="320" id="Exec_per_TType"></canvas>
											</div>
										</div>
									</div>
								</div>

								<!-- Executions per Browser Chart -->
								<div class="col-xl-6 col-lg-5">
									<div class="card shadow mb-4 mr-1">
										<!-- Card Header - Dropdown -->
										<div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
											<h6 class="m-0 font-weight-bold text-dark">Executions per Environment till date</h6>

										</div>
										<!-- Card Body -->
										<div class="card-body">
											<div class="alert alert-info text-center" id="EnvExecs_ZeroDataDiv" style="display: none;"></div>
											<div id="EnvExecs_spinner" class="text-center">
												<div class="spinner-grow spinner-grow-sm" role="status">
													<span class="sr-only">Loading...</span>
												</div>
											</div>
											<div class="chart-area" id="EnvExecs_ChartDiv">
												<canvas width="479" height="320" id="Exec_per_Env"></canvas>
											</div>
										</div>
									</div>
								</div>
							</div>

						</div>


					</div>
					<!-- /.container-fluid -->
			</div>
			<!-- End of Main Content -->



			<!-- Footer -->
			<footer class="sticky-footer bg-white">
				<div class="container my-auto">
					<div class="copyright text-center my-auto">
						<span>Copyright &copy; Mastek Ltd. 2023</span>
					</div>
				</div>
			</footer>
			<!-- End of Footer -->

		</div>
		<!-- End of Content Wrapper -->

	</div>
	<!-- End of Page Wrapper -->

	<!-- Scroll to Top Button-->
	<a class="scroll-to-top rounded" href="#page-top"> <i class="fas fa-angle-up"></i>
	</a>

	<!-- Logout Modal-->
	<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
					<button class="close" type="button" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">Ã—</span>
					</button>
				</div>
				<div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
				<div class="modal-footer">
					<button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
					<a class="btn btn-primary" href="/automation">Logout</a>
				</div>
			</div>
		</div>
	</div>




	<link href="vendor/bootstrap/css/bootstrap-select.min.css" rel="stylesheet">
	<script src="/resources/vendor/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/resources/js/CS_RBA.js"></script>

	<script src="/resources/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
	<script src="vendor/bootstrap/js/bootstrap-select.min.js"></script>

	<script src="/resources/js/project_bootstrap.min.js"></script>

	<script src="/resources/vendor/chart.js/Chart.min.js"></script>
	<script src="/resources/vendor/extras/html2canvas.js"></script>
	<script src="/resources/vendor/extras/jspdf.min.js"></script>
	<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.debug.js"></script>  -->
	<script src="/resources/vendor/chart.js/chartjs-plugin-datalabels.min.js"></script>
	<script src="/resources/js/myFunctions.js"></script>
	<script src="/resources/js/Dashboard.js"></script>
	<script>

	
	
  $(document).ready(function() {
	  
	  
	  var now = new Date().getTime();
	 
	  
	  var setupTime = localStorage.getItem('setupTime');
	  var logoutcheck=localStorage.getItem('logout');
	  var hiddenSpanValue=document.getElementById('hiddenSpan').innerHTML;
	  
	 
	
		  if(hiddenSpanValue == "newLogin" )
		  {
		  
			  localStorage.setItem('logout','login');
			  localStorage.setItem('setupTime', now);
		  
		  }
	
	  if( setupTime == null  &&  logoutcheck == 'login' )
		  
		  {
			
	    	  localStorage.setItem('setupTime', now);
	    	  localStorage.setItem('logout','login');
		  }
	  
	  
	  var newSetupTime = localStorage.getItem('setupTime');
	  var diff=now-newSetupTime;
	  
	  if((now-newSetupTime) > 3600000)
		  {
		 	     	   
	          window.location.href = "/automation";
	          localStorage.setItem('logout','logout');
		  
		  }
	  
	  
	  
	  var name = document.getElementById('loginUser').innerHTML;
	  var loginEmail=document.getElementById('loginEmail').innerHTML;
	  var hiddenSpanValue=document.getElementById('hiddenSpan').innerHTML;
	  
	
	  if (hiddenSpanValue == "newLogin")
		  {		
		  		localStorage.clear();
			  	localStorage.setItem("name", name);
			  	localStorage.setItem("loginEmail",loginEmail);
			  	localStorage.setItem("sidebar", "expanded");
			  	localStorage.setItem('setupTime', now);
		  }	
	  
	  else
		{		  
			var indexName=localStorage.getItem("name");
			var indexLoginEmail=localStorage.getItem("loginEmail");			
			var sidebar_class = localStorage.getItem("sidebar");
			document.getElementById('loginUser').innerHTML=indexName;
			document.getElementById('loginEmail').innerHTML=indexLoginEmail;
			
		}
		
	  if(localStorage.getItem("sidebar"))
	    {
		  var sidebar_class = localStorage.getItem("sidebar");
		  if (sidebar_class == "collapsed") {
		  	$(".sidebar").toggleClass("toggled");
		  	
		  }	else{
			  $(".sidebar").removeClass("toggled");  			 
		  }
			 
	    }
	  
	  	
          
	  $.ajax({        
	         url: 'getServerStatus',
	         type: 'GET',             
	         
	         success: function(response) {
	        
	         if(response=="on")
	        	 {
	        	 document.getElementById("serverSwitch").checked = true;
	        	 }
	         else
	        	 {
	        	 document.getElementById("serverSwitch").checked = false;
	        	 }
	           
	         }           
	     });
	  
		});
  
  </script>


	<script>

</script>

	<script>
function printToPDF() {
		document.getElementById('LoadingImage').style.display = "block";

	  var printableArea = document.getElementById('pdfContent');

	  html2canvas(printableArea, {
	    useCORS: true,
	    onrendered: function(canvas) {

	      var pdf = new jsPDF('p', 'pt', 'letter');

	      var pageHeight = 1375; 
	      var pageWidth = printableArea.offsetWidth * (110/100);
	      
	      
	      	for (var i = 0; i <= printableArea.clientHeight / pageHeight; i++) {
	        var srcImg = canvas;
	        var sX = 0;
	        var sY = pageHeight * i; /* start 1 pageHeight down for every new page */
	        var sWidth = pageWidth;
	        var sHeight = pageHeight;
	        var dX = 0;
	        var dY = 0;
	        var dWidth = pageWidth;
	        var dHeight = pageHeight;

	        window.onePageCanvas = document.createElement("canvas");
	        onePageCanvas.setAttribute('width', pageWidth);
	        onePageCanvas.setAttribute('height', pageHeight);
	        var ctx = onePageCanvas.getContext('2d');
	        ctx.drawImage(srcImg, sX, sY, sWidth, sHeight, dX, dY, dWidth, dHeight);

	        var canvasDataURL = onePageCanvas.toDataURL("image/png", 5.0);
	        var width = onePageCanvas.width;
	        var height = onePageCanvas.clientHeight;
			
	        
	        if (i > 0) /* if we're on anything other than the first page, add another page */
	          
	        pdf.addPage(612, 791); /* 8.5" x 11" in pts (inches*72) */

	        pdf.setPage(i + 1); /* now we declare that we're working on that page */
	  
	        var sidebar_class = localStorage.getItem("sidebar");			
	        
	        if(sidebar_class == "expanded"){
	        	pdf.addImage(canvasDataURL, 'PNG', 20, 40, (width * .53), (height * .62));  /* For sidebar expanded */
	        } else if(sidebar_class == "collapsed"){
	        	pdf.addImage(canvasDataURL, 'PNG', 20, 40, (width * .475), (height * .62));  /* For sidebar collapsed */
	        }	
	      }
	         pdf.save('One Automation Solution_Project_Summary.pdf'); 
	         document.getElementById('LoadingImage').style.display = "none";
	         
	    }
	  });
	}
</script>
	<script>
 function cTrig(box) {
		
		var serverStatus=document.getElementById("serverSwitch").checked;
		
		if (serverStatus==true)
		{
			console.log("Automation Server ON");
			var retValOn = confirm("Are you sure you want to switch the Automation Server ON ?");
			
		 if (retValOn==true) {
        $.ajax({        
            url: 'serverSwitch',
            type: 'post',             
             data: {
               "serverStatus": 'on'
            },
            success: function(response) {
           
            alert("Automation Server is ON");
              
            }           
        });
    
  		}
  		
  		 else {
    		
    		console.log("Confirmation is cancel");
    		document.getElementById("serverSwitch").checked = false;
   		 }
  		
			
			
	}
		else
		{
			console.log("Automation Server OFF");
			var retValOff = confirm("Are you sure you want to switch the Automation Server OFF ?");
			
		 if (retValOff==true) {
        $.ajax({        
            url: 'serverSwitch',
            type: 'post',             
             data: {
               "serverStatus": 'off'
            },
            success: function(response) {
           
            alert("Automation Server is OFF");
              
            }           
        });
    
  		}
  		
  		 else {
    		
    		console.log("Confirmation is cancel");
    		document.getElementById("serverSwitch").checked = true;
   		 }
  
  }
	
	
     
}



		
	 </Script>


</body>


</html>